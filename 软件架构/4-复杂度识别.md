## <center> 复杂度识别 </center>
架构设计的本质是解决软件复杂性，所以在我们设计架构之前，首先需要考虑系统的复杂性
。架构的复杂性来源于“高性能”、“高可用”、“可扩展”等几个方面，在实际的大部分的场景中，复杂度只是其中的一个，少部分情况是两个。
### 第一步：分析复杂性
当一个软件出现了上面三种情况时，应该是架构师的判断出现了失误，大型的软件往往设计架构时更应该注意，设计的太过复杂也会导致其他问题：
- 系统复杂无比，运维效率低下,每一次的升级都需要对十几个子系统进行升级，操作复杂，容易失误。
- 每次版本开发和升级都需要十几个子系统配合，开发效率低下。
- 子系统数量太多，关系复杂，小问题不断，而且出问题后定位困难。

当接手一款复杂性上有问题的软件时， 可能会面临如下几个问题:
- 需要做的事情非常多，无从下手；
- 设计方案本身太过复杂，落地时间遥遥无期；
- 同一个方案要解决不同的复杂性，有的设计点是互相矛盾的。例如，要提升系统可用性，就需要将数据及时存储到硬盘上，而硬盘刷盘反过来又会影响系统性能；

因此正确的做法是**将主要的复杂度问题列出来，然后根据业务、技术、团队等综合情况进行排序，优先解决当前面临的最主要的复杂度问题**.对于按照复杂度优先级解决的方式，存在一个普遍的担忧：如果按照优先级来解决复杂度，可能会出现解决了优先级排在前面的复杂度后，解决后续复杂度的方案需要将已经落地的方案推倒重来。这个担忧理论上是可能的，但现实中几乎是不可能出现的，原因在于软件系统的可塑性和易变性。对于同一个复杂度问题，软件系统的方案可以有多个，总是可以挑出综合来看性价比最高的方案。

#### 小节
识别复杂度可以通过排查法进行分析，对一个系统的设计，从高性能、高可用、高扩展（或者安全性、低成本、规模等等）进行考虑.结合需求、技术、团队、资源等对上述复杂度逐一分析是否需要？是否关键？
- “高性能”主要从软件系统未来的TPS、响应时间、服务器资源利用率等客观指标，也可以从用户的主观感受方面去考虑。
- “可用性”主要从服务不中断等质量属性，符合行业政策、国家法规等方面去考虑。
- “扩展性”则主要从功能需求的未来变更幅度等方面去考虑。

##### 附
作者回复: 对于架构师来说，常见系统的性能量级需要烂熟于心，例如nginx负载均衡性能是3万左右，mc的读取性能5万左右，kafka号称百万级，zookeeper写入读取2万以上，http请求访问大概在2万左右。

### 第二步：设计备用方案
当前新技术实际上是以往的老技术进行组合而得到的,例如：
- NoSQL：Key-Value 的存储和数据库的索引其实是类似的，Memcache 只是把数据库的索引独立出来做成了一个缓存系统。
- Hadoop 大文件存储方案，基础其实是集群方案 + 数据复制方案。
- Docker 虚拟化，基础是 LXC（Linux Containers).
- LevelDB 的文件存储结构是 Skip List。

虽然基于已有的方案进行排列组合就可以得到大部分我们需要的方案，但是数量实在是太多了,架构师在考虑时往往会犯以下错误：
- 一开始就想设计一个最优秀的方案，这违背了架构设计原则的合适原则和简单原则。
- 只设计出一个方案，应该做3-5个备选方案。
- 备选方案设计太过详细。
