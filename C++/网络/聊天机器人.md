以muduo中的asio/chat为例

聊天服务的特点是“连接之间的数据有交流，从a中接收到的数据要发送给b”，防止串话，描述符的误用，如何处理多个连接，都是要解决的问题。

#### 消息格式
每条消息中有4字节的头文件，不需要使用\\0作为结尾。

#### 字节序转换
函数`hostToNetwork()`传入参数是整数，表示的是数据的长度，在做网络序和主机序的转换时需要用到数据长度这个属性。所以先将其进行转换存储。

---

## 在一些代码中的锁的作用
由于share_ptr中有两个参数（ptr和cnt），在进行读写操作的时候不能原子化，share_ptr的线程安全级别和内建类型，string类型都是一样的，总的来说：
-  一个share_ptr对象实体可以被多个线程同时读取。
- 两个share_ptr对象实体可以被两个线程同时读取写入。
- 要想从多个线程读写同一个share_ptr对象，那么需要加锁。
[讲解](https://www.cnblogs.com/lenmom/p/9198126.html)
